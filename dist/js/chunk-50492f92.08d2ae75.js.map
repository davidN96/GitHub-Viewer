{"version":3,"sources":["webpack:///./src/views/SearchResults.vue?dab9","webpack:///./src/views/SearchResults.vue?743e","webpack:///./src/utils/view/index.ts","webpack:///./src/views/SearchResults.vue","webpack:///./src/views/SearchResults.vue?5f76","webpack:///./src/views/SearchResults.vue?1fbf"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","error","attrs","title","message","redirection","_e","data","isFetching","class","fadedIn","fadedOut","searchFilterControl","perPageOptions","sortOptions","orderOptions","resultsCount","searchFilters","sort","order","perPage","on","handleFiltersChange","searchPageControl","page","maxPage","_l","item","key","node_id","mode","handlePageChange","staticRenderFns","scrollTop","delay","setTimeout","window","scrollTo","$route","params","keyword","isActive","results","parseInt","user","length","desc","$store","state","requests","search","count","profile","commit","type","quantity","q","findUser","findRepository","decrementRequestCount","hideLoader","searchUser","searchRepository","total_count","items","showError","status","handleRequestFinish","$router","push","handleSearch","changePage","recalculatePages","deep","components","ItemTile","component"],"mappings":"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","file":"js/chunk-50492f92.08d2ae75.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchResults.vue?vue&type=style&index=0&id=5cc88d88&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"searchResultsWrapper\"},[(_vm.error.isActive)?_c('ErrorModal',{attrs:{\"title\":_vm.error.title,\"message\":_vm.error.message,\"redirectTo\":_vm.error.redirection}}):_vm._e(),_c('Loader',{attrs:{\"isActive\":_vm.data.isFetching}}),_c('div',{staticClass:\"list\",class:{ fadedIn: !_vm.data.isFetching, fadedOut: _vm.data.isFetching }},[_c('SearchFilters',{attrs:{\"perPageOptions\":_vm.searchFilterControl.perPageOptions,\"sortOptions\":_vm.searchFilterControl.sortOptions,\"orderOptions\":_vm.searchFilterControl.orderOptions,\"results\":_vm.data.resultsCount,\"sort\":_vm.searchFilters.sort,\"order\":_vm.searchFilters.order,\"perPage\":_vm.searchFilters.perPage},on:{\"filtersChange\":_vm.handleFiltersChange}}),_c('ResultsCounter',{attrs:{\"results\":_vm.data.resultsCount,\"page\":_vm.searchPageControl.page,\"maxPage\":_vm.searchPageControl.maxPage}}),_vm._l((_vm.data.results),function(item){return _c('ItemTile',{key:item.node_id,attrs:{\"item\":item,\"type\":_vm.mode}})}),_c('Paginator',{attrs:{\"page\":_vm.searchPageControl.page,\"maxPage\":_vm.searchPageControl.maxPage},on:{\"pageChange\":_vm.handlePageChange}})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const scrollTop = (delay: number) =>\r\n  setTimeout(() => window.scrollTo(0, 0), delay);\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Vue, Component, Watch } from 'vue-property-decorator';\r\nimport { scrollTop } from '@/utils/view';\r\nimport * as SearchTypes from '@/global';\r\nimport * as APITypes from '@/controllers/api/types';\r\nimport * as Search from '@/utils/search';\r\nimport ItemTile from '@/components/ItemTile/index.vue';\r\nimport API from '@/controllers/api';\r\n\r\n@Component({ components: { ItemTile } })\r\nexport default class SearchResult extends Vue {\r\n  private mode: string = this.$route.params.mode;\r\n  private keyword: string = this.$route.params.keyword;\r\n\r\n  private error: SearchTypes.AppError = {\r\n    isActive: false,\r\n    title: 'Sorry',\r\n    message: 'Error ocurred',\r\n    redirection: '',\r\n  };\r\n\r\n  private data: SearchTypes.SearchResults = {\r\n    results: [],\r\n    resultsCount: 0,\r\n    isFetching: true,\r\n  };\r\n\r\n  private searchPageControl: SearchTypes.SearchPageControl = {\r\n    page: parseInt(this.$route.params.page),\r\n    maxPage: 1,\r\n  };\r\n\r\n  private searchFilterControl: SearchTypes.ExtendedSearchFilterControl = {\r\n    sortOptions:\r\n      this.mode === SearchTypes.SearchMode.user\r\n        ? SearchTypes.userSortOptions\r\n        : SearchTypes.repoSortOptions,\r\n    perPageOptions: SearchTypes.perPageOptions,\r\n    orderOptions: SearchTypes.orderOptions,\r\n  };\r\n\r\n  private searchFilters: SearchTypes.ExtendedSearchFilters = {\r\n    perPage: SearchTypes.perPageOptions[0],\r\n    sort: this.searchFilterControl.sortOptions?.length\r\n      ? this.searchFilterControl.sortOptions[0]\r\n      : null,\r\n    order: APITypes.Order.desc,\r\n  };\r\n\r\n  private handlePageChange(page: number): void {\r\n    this.searchPageControl.page = page;\r\n  }\r\n\r\n  private get searchCount(): number {\r\n    return this.$store.state.requests.search.count;\r\n  }\r\n\r\n  private get profileCount(): number {\r\n    return this.$store.state.requests.profile.count;\r\n  }\r\n\r\n  private decrementRequestCount(): void {\r\n    this.$store.commit('decrementRequestCount', {\r\n      type: 'search',\r\n      quantity: 1,\r\n    });\r\n  }\r\n\r\n  private showLoader(): void {\r\n    this.data.isFetching = true;\r\n  }\r\n\r\n  private hideLoader(): void {\r\n    setTimeout(() => (this.data.isFetching = false), 300);\r\n  }\r\n\r\n  private showError(title: string, message: string): void {\r\n    this.error = {\r\n      title,\r\n      message,\r\n      isActive: true,\r\n      redirection: '/',\r\n    };\r\n  }\r\n\r\n  private async searchUser(): Promise<APITypes.FindItemResponse> {\r\n    const params: APITypes.FindItemFullParams = {\r\n      q: this.keyword,\r\n      page: this.searchPageControl.page,\r\n      ...this.searchFilters,\r\n    };\r\n\r\n    const data: APITypes.FindItemResponse = await API.findUser(params);\r\n\r\n    return data;\r\n  }\r\n\r\n  private async searchRepository(): Promise<APITypes.FindItemResponse> {\r\n    const params: APITypes.FindItemFullParams = {\r\n      q: this.keyword,\r\n      page: this.searchPageControl.page,\r\n      ...this.searchFilters,\r\n    };\r\n\r\n    return await API.findRepository(params);\r\n  }\r\n\r\n  private handleRequestFinish(): void {\r\n    this.decrementRequestCount();\r\n    this.hideLoader();\r\n  }\r\n\r\n  private async handleSearch(): Promise<void> {\r\n    this.data.isFetching = true;\r\n\r\n    try {\r\n      const data =\r\n        this.mode === SearchTypes.SearchMode.user\r\n          ? await this.searchUser()\r\n          : await this.searchRepository();\r\n\r\n      this.data.resultsCount = Search.countResults(data.total_count, 1000);\r\n      this.data.results = data.items;\r\n      this.searchPageControl.maxPage = Search.countPages(\r\n        this.data.resultsCount,\r\n        this.searchFilters.perPage\r\n      );\r\n\r\n      if (data.total_count === 0) this.showError('Sorry', 'No results found');\r\n    } catch (error) {\r\n      if (error?.status === 403) this.showError('Sorry', 'API limit exceeded');\r\n      else this.showError('Sorry', 'API error ocurred. Please refresh page');\r\n    } finally {\r\n      this.handleRequestFinish();\r\n    }\r\n  }\r\n\r\n  private recalculatePages(): void {\r\n    this.searchPageControl.maxPage = Search.countPages(\r\n      this.data.resultsCount,\r\n      this.searchFilters.perPage\r\n    );\r\n    if (this.searchPageControl.page > this.searchPageControl.maxPage)\r\n      this.searchPageControl.page = this.searchPageControl.maxPage;\r\n  }\r\n\r\n  private changePage(): void {\r\n    this.$router.push({\r\n      params: { ...this.$route.params, page: `${this.searchPageControl.page}` },\r\n    });\r\n    scrollTop(250);\r\n  }\r\n\r\n  private handleFiltersChange(params: SearchTypes.ExtendedSearchFilters): void {\r\n    this.searchFilters = params;\r\n  }\r\n\r\n  @Watch('searchPageControl.page')\r\n  private async handlPageChange(): Promise<void> {\r\n    this.handleSearch();\r\n    this.changePage();\r\n  }\r\n\r\n  @Watch('searchFilters', { deep: true })\r\n  private async handlePerPageChange(): Promise<void> {\r\n    this.recalculatePages();\r\n    this.handleSearch();\r\n  }\r\n\r\n  mounted(): void {\r\n    this.handleSearch();\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchResults.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SearchResults.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SearchResults.vue?vue&type=template&id=5cc88d88&scoped=true&\"\nimport script from \"./SearchResults.vue?vue&type=script&lang=ts&\"\nexport * from \"./SearchResults.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SearchResults.vue?vue&type=style&index=0&id=5cc88d88&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5cc88d88\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}